---
title: "AWS Lambda ãƒˆãƒ©ãƒ–ãƒ«è§£æ±ºã«å‘ã‘ãŸåŸå› åˆ‡ã‚Šåˆ†ã‘æ–¹æ³•ï¼ƒ1"
emoji: "ğŸˆ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: []
published: True
---

# ã¯ã˜ã‚ã«ã€€
AWSæ–™é‡‘ã‚’æ¯æ—¥Slackã¸é€šçŸ¥ã™ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆ  
Lambdaã§ç™ºç”Ÿã—ãŸã‚¨ãƒ©ãƒ¼ã®è§£æ±ºã«å‘ã‘ãŸåŸå› åˆ‡ã‚Šåˆ†ã‘æ–¹æ³•ã‚’è¨˜éŒ²ã«æ®‹ã™  

ä»¥ä¸‹UDEMYæ•™æã‚’ä½¿ç”¨ã—ã€Serverlessã‚¢ãƒ—ãƒªé–‹ç™ºã‚’å­¦ç¿’ä¸­  
https://www.udemy.com/course/aws-lambda-serverless-framework/

# ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³
![](/images/Serverless_APP.png)

# ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°
:::details
  "errorType": "Error",
  "errorMessage": "A request error occurred: connect ECONNREFUSED 127.0.0.1:80",
  "trace": [
    "Error: A request error occurred: connect ECONNREFUSED 127.0.0.1:80",
    "    at requestErrorWithOriginal (webpack:///./node_modules/@slack/webhook/dist/errors.js?:26:33)",
    "    at IncomingWebhook.send (webpack:///./node_modules/@slack/webhook/dist/IncomingWebhook.js?:58:61)",
    "    at processTicksAndRejections (node:internal/process/task_queues:96:5)",
    "    at async Runtime.handler (webpack:///./src/costNotifier.js?:9:3)"
  ]
}
:::
![](/images/Lambda_errorlog.png)


# è§£æ±ºã«å‘ã‘ãŸåŸå› åˆ‡ã‚Šåˆ†ã‘

## ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‹ã‚‰ã‚ã‹ã‚‹ã“ã¨
ECONNREFUSEDã‚¨ãƒ©ãƒ¼  
    ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒ127.0.0.1 (localhost) ã®80ãƒãƒ¼ãƒˆã«æ¥ç¶šã—ã‚ˆã†ã¨ã—ã¦ã€æ¥ç¶šãŒæ‹’å¦ã•ã‚ŒãŸã“ã¨ãŒåˆ†ã‹ã‚‹ã€‚é€šå¸¸ã€ãƒ­ãƒ¼ã‚«ãƒ«ãƒ›ã‚¹ãƒˆã¸é€šä¿¡ã™ã‚‹ã“ã¨ã¯ãªã„ãŸã‚ã€LambdaãŒæ­£ã—ãé€ä¿¡å…ˆã‚’èªè­˜ã§ãã¦ã„ã‚‹ã‹ç¢ºèªãŒã™ã¹ãã€‚
```
"errorMessage": "A request error occurred: connect ECONNREFUSED 127.0.0.1:80"
```

### è§£æ±ºã«å‘ã‘ãŸã‚¹ãƒ†ãƒƒãƒ—
1. Slack webhookã®URLãŒæ­£ã—ãAWS SSMã‹ã‚‰å–å¾—ã•ã‚Œã€ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª  
Lambdaé–¢æ•°ã®ç’°å¢ƒå¤‰æ•°ã‚’ç¢ºèªã—ã€Slack webhookã®URLãŒå–å¾—ã§ãã¦ã„ã‚‹ã‹ç¢ºèª
![](/images/Lambda_env.png)

$[ssm:udemy-aws-lamdba_SLACK_Webhook]ã¨ã„ã†å€¤ã¯ã€å®Ÿéš›ã®Slackã®Webhook URLã«ç½®ãæ›ãˆã‚‹ã¹ãå¤‰æ•°ãŒãã®ã¾ã¾è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã€‚ã“ã®å¤‰æ•°ãŒæ­£ã—ãè§£æ±ºã•ã‚Œãšã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®127.0.0.1ãŒä½¿ã‚ã‚Œã¦ã—ã¾ã£ã¦ã„ã‚‹å¯èƒ½æ€§ãŒè€ƒãˆã‚‰ã‚Œã‚‹ã€‚  
<br>

### åŸå› 
æ§‹æ–‡ã‚¨ãƒ©ãƒ¼

æ­£ã—ã„æ§‹æ–‡
ï½€ï½€ï½€
${ssm:udemy-aws-lamdba_SLACK_Webhook}
ï½€ï½€ï½€
<br>
èª¤ã£ãŸæ§‹æ–‡
ï½€ï½€ï½€
$[ssm:udemy-aws-lamdba_SLACK_Webhook]
ï½€ï½€ï½€

